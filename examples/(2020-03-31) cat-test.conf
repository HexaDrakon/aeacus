# Cool Practice Image
name = "cat-test"
title = "Aeacus Test Run Round"
user = "catsrcool"
os = "Debian 9"
remote = "worker.sourque.dev"

# User checks

[[check]]
[[check.pass]]
type="UserExists"
arg1="cats4lyfe"

[[check]]
[[check.pass]]
type="UserExistsNot"
arg1="doglover"

[[check]]
message = "Removed malicious UID 0 account dog"
points = 8
[[check.pass]]
type="UserExistsNot"
arg1="dog"

[[check]]
[[check.pass]]
type="UserExistsNot"
arg1="catsareokiguess"

[[check]]
message = "Removed valid administrator ilovecats"
points = -5
[[check.pass]]
type="UserExistsNot"
arg1="ilovecats"

[[check]]
message = "Removed main administrator account catsrcool"
points = -500
[[check.pass]]
type="UserExistsNot"
arg1="catsrcool"

# Forensic Questions

[[check]]
[[check.pass]]
type="FileContains"
arg1="/home/catsrcool/Desktop/Forensic Question 1.txt"
arg2="/lib/firmware/hp/coolfile"

[[check]]
[[check.pass]]
type="FileContains"
arg1="/home/catsrcool/Desktop/Forensic Question 2.txt"
arg2="asdf"

[[check]]
[[check.pass]]
type="FileContains"
arg1="/home/catsrcool/Desktop/Forensic Question 3.txt"
arg2="/usr/lib/evolution/slack_call_noise_lol"

[[check]]
[[check.pass]]
type="FileContainsNot"
arg1="/etc/ssh/sshd_config"
arg2="PermitRootLogin yes"

[[check]]
[[check.pass]]
type="FileContainsNot"
arg1="/etc/ssh/sshd_config"
arg2="PubkeyAuthentication yes"

[[check]]
[[check.pass]]
type="FileExistsNot"
arg1="/home/catsrcool/Documents/users.csv"

[[check]]
[[check.pass]]
type="PackageInstalledNot"
arg1="nmap"

[[check]]
[[check.pass]]
type="PackageInstalledNot"
arg1="wireshark"

[[check]]
[[check.pass]]
type="PackageInstalledNot"
arg1="minetest"

[[check]]
points = -10
[[check.pass]]
type="PackageInstalledNot"
arg1="openssh-server"

[[check]]
points = -10
[[check.pass]]
type="PackageInstalledNot"
arg1="samba"

[[check]]
message = "Remove netcat backdoor"
[[check.pass]]
type="FileContainsNot"
arg1="/var/spool/cron/crontabs/root"
arg2="/usr/bin/fw.sh"

[[check]]
message= "A firewall has been enabled"
[[check.pass]]
type="Command"
arg1="ufw status | grep -q ' active'"

[[check]]
message = "Disabled IPv6"
[[check.pass]]
type="FileContains"
arg1="/etc/sysctl.conf"
arg2="net.ipv6.conf.all.disable_ipv6 = 1"

[[check]]
message = "Enabled ASLR"
[[check.pass]]
type="FileContains"
arg1="/etc/sysctl.conf"
arg2="kernel.randomize_va_space = 2"

[[check]]
message = "Removed bashrc backdoor"
[[check.pass]]
type="FileContainsNot"
arg1="/etc/bash.bashrc"
arg2="nc -lvp"

[[check]]
message = "Changed 777 perms for /etc/shadow"
[[check.pass]]
type="CommandNot"
arg1="ls -la /etc/shadow | grep -q 'rwxrwxrwx'"
[[check.fail]]
type="FileExistsNot"
arg1="/etc/shadow"
